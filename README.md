```SQL
CREATE TABLE IF NOT EXISTS medico(
	num_med SERIAL NOT NULL PRIMARY KEY,
	nome VARCHAR(250),
	especialidade VARCHAR(50),
	crm INT

);
```
```SQL
CREATE TABLE IF NOT EXISTS usuarios (
	usu_code SERIAL NOT NULL PRIMARY KEY,
	uso_nome VARCHAR(125),
	usu_senha VARCHAR(15),
	usu_tipo VARCHAR (20)
	);
```
```sql
CREATE TABLE IF NOT EXISTS BAIRRO (
	baicode SERIAL NOT NULL PRIMARY KEY,
	bainome VARCHAR(125)
	
	);
```
```sql
CREATE TABLE IF NOT EXISTS pacientes (
	pac_code SERIAL NOT NULL PRIMARY KEY,
	pac_nome VARCHAR(125),
	pac_nascimento DATE,
	PAC_RG VARCHAR (25),
	PAC_TELEFONE VARCHAR (15),
	pac_rua VARCHAR (135),
	pac_cep VARCHAR (20),
	pac_complemento VARCHAR (50),
	pac_bairro_fkey INT REFERENCES bairro (baicode)
	);
```
```sql
INSERT INTO bairro (bainome) VALUES ('Alto do São Francisco'),('Campo Novo'), ('Campo Velho'), ('Centro'), ('Residencial');
```
```java
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package visao;

import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import modeloConection.Conexao;

/**
 *
 * @author duran
 */
public class TelaLogin extends javax.swing.JFrame {
    Conexao con = new Conexao();
    
    /**
     * Creates new form TelaLogin
     */
    public TelaLogin() {
        initComponents();
        con.Conexao();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jButtonAcessar = new javax.swing.JButton();
        jButtonSair = new javax.swing.JButton();
        jLabelUsuario = new javax.swing.JLabel();
        jLabelSenha = new javax.swing.JLabel();
        jTextFieldUsuario = new javax.swing.JTextField();
        jPasswordFieldSenha = new javax.swing.JPasswordField();
        jLabelFundodeTelaLogin = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        getContentPane().setLayout(null);

        jButtonAcessar.setText("Acessar");
        jButtonAcessar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonAcessarActionPerformed(evt);
            }
        });
        getContentPane().add(jButtonAcessar);
        jButtonAcessar.setBounds(91, 170, 120, 23);

        jButtonSair.setText("Sair");
        jButtonSair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSairActionPerformed(evt);
            }
        });
        getContentPane().add(jButtonSair);
        jButtonSair.setBounds(260, 170, 100, 23);

        jLabelUsuario.setText("Usuario");
        getContentPane().add(jLabelUsuario);
        jLabelUsuario.setBounds(40, 60, 100, 14);

        jLabelSenha.setText("Senha");
        getContentPane().add(jLabelSenha);
        jLabelSenha.setBounds(40, 90, 50, 14);

        jTextFieldUsuario.setBackground(new java.awt.Color(204, 204, 255));
        getContentPane().add(jTextFieldUsuario);
        jTextFieldUsuario.setBounds(120, 60, 120, 20);

        jPasswordFieldSenha.setBackground(new java.awt.Color(153, 153, 255));
        getContentPane().add(jPasswordFieldSenha);
        jPasswordFieldSenha.setBounds(120, 90, 120, 20);

        jLabelFundodeTelaLogin.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/analysis-2030265_640.jpg"))); // NOI18N
        jLabelFundodeTelaLogin.setText("Senha");
        getContentPane().add(jLabelFundodeTelaLogin);
        jLabelFundodeTelaLogin.setBounds(10, 10, 470, 350);

        setSize(new java.awt.Dimension(508, 411));
        setLocationRelativeTo(null);
    }// </editor-fold>                        

    private void jButtonAcessarActionPerformed(java.awt.event.ActionEvent evt) {                                               
            //con.executaSQL("select * from usuarios where uso_nome = '" + jTextFieldUsuario.getText() + "'");
            
        try {
            con.executaSQL("select * from usuarios where uso_nome = '" + jTextFieldUsuario.getText() + "'");
            con.rs.first();
            if(con.rs.getString("usu_senha").equals(jPasswordFieldSenha.getText())){
                TelaPrincipal tela = new TelaPrincipal(jTextFieldUsuario.getText());
                tela.setVisible(true);
                dispose();
            }else{
                JOptionPane.showMessageDialog(rootPane,"Senha ou Usuário inválidos!");
            }
            
            
            
        } catch (SQLException ex) {
            Logger.getLogger(TelaLogin.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(rootPane,"Senha ou Usuário com Problemas!" +ex.getMessage());
        }
    }                                              

    private void jButtonSairActionPerformed(java.awt.event.ActionEvent evt) {                                            
       System.exit(0);
    }                                           

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TelaLogin.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TelaLogin.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TelaLogin.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TelaLogin.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new TelaLogin().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify                     
    private javax.swing.JButton jButtonAcessar;
    private javax.swing.JButton jButtonSair;
    private javax.swing.JLabel jLabelFundodeTelaLogin;
    private javax.swing.JLabel jLabelSenha;
    private javax.swing.JLabel jLabelUsuario;
    private javax.swing.JPasswordField jPasswordFieldSenha;
    private javax.swing.JTextField jTextFieldUsuario;
    // End of variables declaration                   
}
```
```java
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package visao;

import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import modeloConection.Conexao;

/**
 *
 * @author duran
 */
public class TelaPrincipal extends javax.swing.JFrame {

    Conexao conecta = new Conexao();
    FormMedico tela = new FormMedico();
    FormUsuario telaUsu = new FormUsuario();
    FormPaciente telapac = new FormPaciente();
    
    public TelaPrincipal(String usuario) {
        initComponents();
        jTextFieldUsuario.setText(usuario);
        conecta.Conexao();
    }

    private TelaPrincipal() {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jLabelUsuario = new javax.swing.JLabel();
        jInternalFrameBemVindo = new javax.swing.JInternalFrame();
        jPanelFrameInternoTelaBemVindo = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jButtonCadMedicos = new javax.swing.JButton();
        jButtonCadEnfermeiras = new javax.swing.JButton();
        jButtonCadPacientes = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        jButtonAgenda = new javax.swing.JButton();
        jLabelFundoPainelInterno = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jButtonFecharBemVindo = new javax.swing.JButton();
        jTextFieldUsuario = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        jLabelFundoTelaPrincipal = new javax.swing.JLabel();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenuCadastro = new javax.swing.JMenu();
        jMenuItemCadMedicos = new javax.swing.JMenuItem();
        jMenuItemCadEnfermeiras = new javax.swing.JMenuItem();
        jMenuItemCadUsuários = new javax.swing.JMenuItem();
        jMenuRelatorio = new javax.swing.JMenu();
        jMenuFerramentas = new javax.swing.JMenu();
        jMenuItemTelaBemVindos = new javax.swing.JMenuItem();
        jMenuSair = new javax.swing.JMenu();
        jMenuItemSair = new javax.swing.JMenuItem();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        getContentPane().setLayout(null);
        getContentPane().add(jLabelUsuario);
        jLabelUsuario.setBounds(140, 280, 80, 0);

        jInternalFrameBemVindo.setBackground(new java.awt.Color(153, 153, 255));
        jInternalFrameBemVindo.setTitle("Bem Vindo");
        jInternalFrameBemVindo.setVisible(true);
        jInternalFrameBemVindo.getContentPane().setLayout(null);

        jPanelFrameInternoTelaBemVindo.setBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(153, 153, 255), new java.awt.Color(102, 0, 102)));
        jPanelFrameInternoTelaBemVindo.setLayout(null);

        jLabel2.setText("Cadastros");
        jPanelFrameInternoTelaBemVindo.add(jLabel2);
        jLabel2.setBounds(20, 20, 60, 14);

        jButtonCadMedicos.setText("Médicos");
        jButtonCadMedicos.setToolTipText("Cadastro de Médicos");
        jButtonCadMedicos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCadMedicosActionPerformed(evt);
            }
        });
        jPanelFrameInternoTelaBemVindo.add(jButtonCadMedicos);
        jButtonCadMedicos.setBounds(10, 60, 80, 23);

        jButtonCadEnfermeiras.setText("Enfermeiras");
        jButtonCadEnfermeiras.setToolTipText("Cadastro de Enfermeiras");
        jPanelFrameInternoTelaBemVindo.add(jButtonCadEnfermeiras);
        jButtonCadEnfermeiras.setBounds(110, 60, 110, 23);

        jButtonCadPacientes.setText("Pacientes");
        jButtonCadPacientes.setToolTipText("Cadastro de Pacientes");
        jButtonCadPacientes.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCadPacientesActionPerformed(evt);
            }
        });
        jPanelFrameInternoTelaBemVindo.add(jButtonCadPacientes);
        jButtonCadPacientes.setBounds(240, 60, 110, 23);

        jLabel3.setText("Agenda");
        jPanelFrameInternoTelaBemVindo.add(jLabel3);
        jLabel3.setBounds(40, 110, 50, 14);

        jButtonAgenda.setText("Agenda");
        jButtonAgenda.setToolTipText("Agenda");
        jPanelFrameInternoTelaBemVindo.add(jButtonAgenda);
        jButtonAgenda.setBounds(30, 140, 100, 23);

        jLabelFundoPainelInterno.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/analysis-2030265_640.jpg"))); // NOI18N
        jPanelFrameInternoTelaBemVindo.add(jLabelFundoPainelInterno);
        jLabelFundoPainelInterno.setBounds(4, 4, 440, 190);

        jInternalFrameBemVindo.getContentPane().add(jPanelFrameInternoTelaBemVindo);
        jPanelFrameInternoTelaBemVindo.setBounds(0, 40, 450, 190);

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel1.setText("Sistema de Gerenciamento de:");
        jInternalFrameBemVindo.getContentPane().add(jLabel1);
        jLabel1.setBounds(4, 10, 300, 22);

        jButtonFecharBemVindo.setText("Fechar");
        jButtonFecharBemVindo.setToolTipText("Fechar Tela Bem Vindo");
        jButtonFecharBemVindo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonFecharBemVindoActionPerformed(evt);
            }
        });
        jInternalFrameBemVindo.getContentPane().add(jButtonFecharBemVindo);
        jButtonFecharBemVindo.setBounds(323, 10, 100, 23);

        getContentPane().add(jInternalFrameBemVindo);
        jInternalFrameBemVindo.setBounds(10, 20, 460, 260);
        getContentPane().add(jTextFieldUsuario);
        jTextFieldUsuario.setBounds(140, 280, 100, 20);

        jLabel4.setText("Usuário:");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(50, 280, 50, 14);

        jLabelFundoTelaPrincipal.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/analysis-2030265_640.jpg"))); // NOI18N
        getContentPane().add(jLabelFundoTelaPrincipal);
        jLabelFundoTelaPrincipal.setBounds(4, 4, 470, 300);

        jMenuCadastro.setText("Cadastro");

        jMenuItemCadMedicos.setText("Médicos");
        jMenuItemCadMedicos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItemCadMedicosActionPerformed(evt);
            }
        });
        jMenuCadastro.add(jMenuItemCadMedicos);

        jMenuItemCadEnfermeiras.setText("Enfermeiras");
        jMenuCadastro.add(jMenuItemCadEnfermeiras);

        jMenuItemCadUsuários.setText("Usuários");
        jMenuItemCadUsuários.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItemCadUsuáriosActionPerformed(evt);
            }
        });
        jMenuCadastro.add(jMenuItemCadUsuários);

        jMenuBar1.add(jMenuCadastro);

        jMenuRelatorio.setText("Relatório");
        jMenuBar1.add(jMenuRelatorio);

        jMenuFerramentas.setText("Ferramentas");

        jMenuItemTelaBemVindos.setText("Tela bem vindos");
        jMenuItemTelaBemVindos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItemTelaBemVindosActionPerformed(evt);
            }
        });
        jMenuFerramentas.add(jMenuItemTelaBemVindos);

        jMenuBar1.add(jMenuFerramentas);

        jMenuSair.setText("Sair");

        jMenuItemSair.setText("Sair");
        jMenuItemSair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItemSairActionPerformed(evt);
            }
        });
        jMenuSair.add(jMenuItemSair);

        jMenuBar1.add(jMenuSair);

        setJMenuBar(jMenuBar1);

        setSize(new java.awt.Dimension(499, 376));
        setLocationRelativeTo(null);
    }// </editor-fold>                        

    private void jButtonFecharBemVindoActionPerformed(java.awt.event.ActionEvent evt) {                                                      
       jInternalFrameBemVindo.dispose();
    }                                                     

    private void jMenuItemSairActionPerformed(java.awt.event.ActionEvent evt) {                                              
     
      conecta.Desconecta();
       System.exit(0);
    }                                             

    private void jMenuItemTelaBemVindosActionPerformed(java.awt.event.ActionEvent evt) {                                                       
        TelaPrincipal tela = new TelaPrincipal();
        tela.setVisible(true);
        dispose();
    }                                                      

    private void jMenuItemCadMedicosActionPerformed(java.awt.event.ActionEvent evt) {                                                    
      
        try {
            conecta.executaSQL("SELECT * FROM usuarios WHERE uso_nome = '"+ jTextFieldUsuario.getText() + "'");
            
            conecta.rs.first();
            if(conecta.rs.getString("usu_tipo").equals("Administrador")){
                if(tela == null){
                    tela = new FormMedico();
                    tela.setVisible(true);
                    tela.setResizable(false);
                }else{
                    tela.setVisible(true);
                    tela.setResizable(false);
                }
            }else{
                JOptionPane.showMessageDialog(rootPane, "Somente o Administrador pode acessar essa Tela");
            }
        } catch (SQLException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(rootPane, "Somente o Administrador pode acessar ess Tela" + ex.getMessage());
        }
        
    }                                                   

    private void jButtonCadMedicosActionPerformed(java.awt.event.ActionEvent evt) {                                                  
      try {
            conecta.executaSQL("SELECT * FROM usuarios WHERE uso_nome = '"+ jTextFieldUsuario.getText() + "'");
            
            conecta.rs.first();
            if(conecta.rs.getString("usu_tipo").equals("Administrador")){
                if(tela == null){
                    tela = new FormMedico();
                    tela.setVisible(true);
                    tela.setResizable(false);
                }else{
                    tela.setVisible(true);
                    tela.setResizable(false);
                }
            }else{
                JOptionPane.showMessageDialog(rootPane, "Somente o Administrador pode acessar essa Tela");
            }
        } catch (SQLException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(rootPane, "Somente o Administrador pode acessar ess Tela" + ex.getMessage());
        }
    }                                                 

    private void jMenuItemCadUsuáriosActionPerformed(java.awt.event.ActionEvent evt) {                                                     
      
        try {
            conecta.executaSQL("SELECT * FROM usuarios WHERE uso_nome = '"+ jTextFieldUsuario.getText() + "'");
            
            conecta.rs.first();
            if(conecta.rs.getString("usu_tipo").equals("Administrador")){
                if(telaUsu==null){
                    telaUsu = new FormUsuario();
                    telaUsu.setVisible(true);
                    telaUsu.setResizable(false);
                }else{
                    telaUsu.setVisible(true);
                    telaUsu.setResizable(false);
                }
            }else{
                JOptionPane.showMessageDialog(rootPane, "Somente o Administrador pode acessar essa Tela");
            }
        } catch (SQLException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(rootPane, "Somente o Administrador pode acessar ess Tela" + ex.getMessage());
        }
        
    }                                                    

    private void jButtonCadPacientesActionPerformed(java.awt.event.ActionEvent evt) {                                                    
        telapac = new FormPaciente();
        telapac.setVisible(true);
        telapac.setResizable(false);
                   
                   
    }                                                   

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new TelaPrincipal().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify                     
    private javax.swing.JButton jButtonAgenda;
    private javax.swing.JButton jButtonCadEnfermeiras;
    private javax.swing.JButton jButtonCadMedicos;
    private javax.swing.JButton jButtonCadPacientes;
    private javax.swing.JButton jButtonFecharBemVindo;
    private javax.swing.JInternalFrame jInternalFrameBemVindo;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabelFundoPainelInterno;
    private javax.swing.JLabel jLabelFundoTelaPrincipal;
    private javax.swing.JLabel jLabelUsuario;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenu jMenuCadastro;
    private javax.swing.JMenu jMenuFerramentas;
    private javax.swing.JMenuItem jMenuItemCadEnfermeiras;
    private javax.swing.JMenuItem jMenuItemCadMedicos;
    private javax.swing.JMenuItem jMenuItemCadUsuários;
    private javax.swing.JMenuItem jMenuItemSair;
    private javax.swing.JMenuItem jMenuItemTelaBemVindos;
    private javax.swing.JMenu jMenuRelatorio;
    private javax.swing.JMenu jMenuSair;
    private javax.swing.JPanel jPanelFrameInternoTelaBemVindo;
    private javax.swing.JTextField jTextFieldUsuario;
    // End of variables declaration                   
}
```
```java
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package visao;

import java.sql.SQLException;
import java.util.ArrayList;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFormattedTextField;
import javax.swing.JOptionPane;
import javax.swing.ListSelectionModel;
import modeloBeans.BeansMedico;
import modeloConection.Conexao;
import modeloDAO.DAOMedico;
import modeloBeans.ModeloTabela;

/**
 *
 * @author duran
 */
public class FormMedico extends javax.swing.JFrame {

    BeansMedico mod = new BeansMedico();
    DAOMedico control = new DAOMedico();
    Conexao conex = new Conexao();
    int flag = 0;
    public FormMedico() {
        initComponents();
        preencherTabela("select * from medico order by nome");
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jFormattedTextFieldCRM = new javax.swing.JFormattedTextField();
        jTextFieldNome = new javax.swing.JTextField();
        jComboBoxEspecialidade = new javax.swing.JComboBox();
        jButtonNovo = new javax.swing.JButton();
        jButtonSalvar = new javax.swing.JButton();
        jButtonEditar = new javax.swing.JButton();
        jButtonExcluir = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButtonCancelar = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTableMedico = new javax.swing.JTable();
        jTextFieldPesquisar = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jTextFieldID = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        getContentPane().setLayout(null);

        jPanel1.setBackground(new java.awt.Color(0, 145, 209));
        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder(new java.awt.Color(102, 102, 255), new java.awt.Color(0, 102, 153)));
        jPanel1.setLayout(null);

        jLabel2.setText("Nome:");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(11, 20, 50, 14);

        jLabel3.setText("CRM:");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(16, 50, 40, 14);

        jLabel4.setText("Especialidade:");
        jPanel1.add(jLabel4);
        jLabel4.setBounds(270, 30, 100, 14);

        jFormattedTextFieldCRM.setEnabled(false);
        jFormattedTextFieldCRM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jFormattedTextFieldCRMActionPerformed(evt);
            }
        });
        jPanel1.add(jFormattedTextFieldCRM);
        jFormattedTextFieldCRM.setBounds(60, 50, 60, 20);

        jTextFieldNome.setEnabled(false);
        jPanel1.add(jTextFieldNome);
        jTextFieldNome.setBounds(70, 20, 110, 20);

        jComboBoxEspecialidade.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Cirurgia", "Dermatologia", "Estetica", "Odontologia" }));
        jComboBoxEspecialidade.setEnabled(false);
        jPanel1.add(jComboBoxEspecialidade);
        jComboBoxEspecialidade.setBounds(380, 30, 90, 20);

        jButtonNovo.setText("Novo");
        jButtonNovo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonNovoActionPerformed(evt);
            }
        });
        jPanel1.add(jButtonNovo);
        jButtonNovo.setBounds(20, 100, 70, 23);

        jButtonSalvar.setText("Salvar");
        jButtonSalvar.setEnabled(false);
        jButtonSalvar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSalvarActionPerformed(evt);
            }
        });
        jPanel1.add(jButtonSalvar);
        jButtonSalvar.setBounds(23, 140, 70, 23);

        jButtonEditar.setText("Editar");
        jButtonEditar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonEditarActionPerformed(evt);
            }
        });
        jPanel1.add(jButtonEditar);
        jButtonEditar.setBounds(20, 230, 70, 23);

        jButtonExcluir.setText("Excluir");
        jButtonExcluir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonExcluirActionPerformed(evt);
            }
        });
        jPanel1.add(jButtonExcluir);
        jButtonExcluir.setBounds(20, 260, 80, 23);

        jButton4.setText("Pesquisar");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        jPanel1.add(jButton4);
        jButton4.setBounds(143, 100, 100, 23);

        jButtonCancelar.setText("Cancelar");
        jButtonCancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCancelarActionPerformed(evt);
            }
        });
        jPanel1.add(jButtonCancelar);
        jButtonCancelar.setBounds(3, 180, 100, 23);

        jTableMedico.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {},
                {},
                {},
                {}
            },
            new String [] {

            }
        ));
        jTableMedico.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTableMedicoMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTableMedico);

        jPanel1.add(jScrollPane1);
        jScrollPane1.setBounds(110, 140, 380, 200);
        jPanel1.add(jTextFieldPesquisar);
        jTextFieldPesquisar.setBounds(270, 100, 200, 20);

        jLabel5.setText("ID");
        jPanel1.add(jLabel5);
        jLabel5.setBounds(200, 60, 11, 14);

        jTextFieldID.setEnabled(false);
        jPanel1.add(jTextFieldID);
        jTextFieldID.setBounds(240, 60, 120, 20);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(20, 40, 500, 360);

        jLabel1.setBackground(new java.awt.Color(204, 204, 255));
        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(0, 51, 204));
        jLabel1.setText("Cadastro de Médicos:");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(80, 10, 150, 17);

        setSize(new java.awt.Dimension(541, 429));
        setLocationRelativeTo(null);
    }// </editor-fold>                        

    private void jFormattedTextFieldCRMActionPerformed(java.awt.event.ActionEvent evt) {                                                       
        // TODO add your handling code here:
    }                                                      

    private void jButtonSalvarActionPerformed(java.awt.event.ActionEvent evt) {                                              
      
       if(jTextFieldNome.getText().isEmpty()){
            
            JOptionPane.showMessageDialog(rootPane, "Preencha o campo Nome");
            jTextFieldNome.requestFocus();
         
       }else if(jFormattedTextFieldCRM.getText().isEmpty()){
           
           JOptionPane.showMessageDialog(rootPane, "Preencha o campo CRM");
           jFormattedTextFieldCRM.requestFocus();
           
       }else
        
        if (flag == 1){
       mod.setNome(jTextFieldNome.getText());
       mod.setEspecialidade((String) jComboBoxEspecialidade.getSelectedItem());
       mod.setCrm(Integer.parseInt(jFormattedTextFieldCRM.getText()));
       control.Salvar(mod);
        jTextFieldPesquisar.setText("");
        jTextFieldNome.setText("");
        jFormattedTextFieldCRM.setText("");
        jTextFieldNome.setEnabled(false);
        jFormattedTextFieldCRM.setEnabled(false);
        jComboBoxEspecialidade.setEnabled(false);
        jButtonSalvar.setEnabled(false);
        jButtonCancelar.setEnabled(!true);
        jButtonNovo.setEnabled(!false);
         preencherTabela("select * from medico order by nome");
      } else {
        mod.setCodigo(Integer.parseInt(jTextFieldID.getText()));
        mod.setNome(jTextFieldNome.getText());
        mod.setEspecialidade((String)jComboBoxEspecialidade.getSelectedItem());
        mod.setCrm(Integer.parseInt(jFormattedTextFieldCRM.getText()));
        control.Editar(mod);
        jTextFieldPesquisar.setText("");
        jTextFieldNome.setText("");
        jFormattedTextFieldCRM.setText("");
        jTextFieldID.setText("");
        jTextFieldNome.setEnabled(true);
        jFormattedTextFieldCRM.setEnabled(false);
        jComboBoxEspecialidade.setEnabled(false);
        jButtonSalvar.setEnabled(false);
        jButtonCancelar.setEnabled(!true);
        jButtonNovo.setEnabled(true);
         preencherTabela("select * from medico order by nome");
        
        
    }
    }                                             

    private void jButtonNovoActionPerformed(java.awt.event.ActionEvent evt) {                                            
        flag =1;
        jTextFieldNome.setEnabled(true);
        jFormattedTextFieldCRM.setEnabled(true);
        jComboBoxEspecialidade.setEnabled(true);
        jButtonSalvar.setEnabled(true);
        jButtonCancelar.setEnabled(true);
        jTextFieldPesquisar.setText("");
        jFormattedTextFieldCRM.setText("");
        jTextFieldNome.setText("");
        jTextFieldID.setText("");
        
        
       
    }                                           

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {                                         
       mod.setPesquisa(jTextFieldPesquisar.getText());
       BeansMedico model = control.bucaMedico(mod);
       jTextFieldNome.setText(model.getNome());
       jTextFieldID.setText(String.valueOf(model.getCodigo()));
       jFormattedTextFieldCRM.setText(String.valueOf(model.getCrm()));
       jComboBoxEspecialidade.setSelectedItem(model.getEspecialidade());
       preencherTabela("SELECT * FROM medico WHERE nome LIKE '%" + mod.getPesquisa() + "%'");
       jButtonEditar.setEnabled(true);
       jButtonExcluir.setEnabled(true);
       jButtonCancelar.setEnabled(true);
       jTextFieldPesquisar.setText("");
       
       
    }                                        

    private void jButtonEditarActionPerformed(java.awt.event.ActionEvent evt) {                                              
        jTextFieldNome.setEnabled(true);
        jFormattedTextFieldCRM.setEnabled(true);
        jComboBoxEspecialidade.setEnabled(true);
        jButtonSalvar.setEnabled(true);
        jButtonEditar.setEnabled(false);
        jButtonNovo.setEnabled(false);
        jButtonExcluir.setEnabled(false);
        jButtonCancelar.setEnabled(true);
        jTextFieldPesquisar.setText("");
        
    }                                             

    private void jButtonCancelarActionPerformed(java.awt.event.ActionEvent evt) {                                                
        jTextFieldNome.setEnabled(!true);
        jFormattedTextFieldCRM.setEnabled(!true);
        jComboBoxEspecialidade.setEnabled(!true);
        jButtonSalvar.setEnabled(!true);
        jButtonNovo.setEnabled(true);
        jButtonExcluir.setEnabled(false);
        jButtonCancelar.setEnabled(true);
        jTextFieldPesquisar.setEnabled(true);
        jButton4.setEnabled(true);
        jTextFieldPesquisar.setText("");
        jFormattedTextFieldCRM.setText("");
        jTextFieldNome.setText("");
        jTextFieldID.setText("");
        
        
        
    }                                               

    private void jButtonExcluirActionPerformed(java.awt.event.ActionEvent evt) {                                               
       int resposta = 0;
       resposta = JOptionPane.showConfirmDialog(rootPane,"deseja realmente excluir?");
       if (resposta == JOptionPane.YES_OPTION){
           mod.setCodigo(Integer.parseInt(jTextFieldID.getText()));
           control.Excluir(mod);
           jTextFieldPesquisar.setText("");
        jTextFieldNome.setText("");
        jFormattedTextFieldCRM.setText("");
        jTextFieldID.setText("");
        jTextFieldNome.setEnabled(true);
        jFormattedTextFieldCRM.setEnabled(false);
        jComboBoxEspecialidade.setEnabled(false);
        jButtonSalvar.setEnabled(false);
        jButtonCancelar.setEnabled(!true);
        jButtonNovo.setEnabled(true);
       }
    }                                              

    private void jTableMedicoMouseClicked(java.awt.event.MouseEvent evt) {                                          
        String nome_medico = "" + jTableMedico.getValueAt(jTableMedico.getSelectedRow(), 1);
        conex.Conexao();
        conex.executaSQL("select * from medico where nome ='" + nome_medico + "'");
        
        try {
            conex.rs.first();
            jTextFieldID.setText(String.valueOf(conex.rs.getInt("num_med")));
            jTextFieldNome.setText(conex.rs.getString("nome"));
            jComboBoxEspecialidade.setSelectedItem(conex.rs.getString("especialidade"));
            jFormattedTextFieldCRM.setText(conex.rs.getString("crm"));
        } catch (SQLException ex) {
            Logger.getLogger(FormMedico.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(rootPane, "algo errado no mouseClick" + ex);
        }
        
        conex.Desconecta();
        jButtonEditar.setEnabled(true);
        jButtonExcluir.setEnabled(true);
    }                                         

    public void preencherTabela(String sql){
        ArrayList dados = new ArrayList();
        String [] colunas = new String []{"Id","Nome", "Especialidade", "CRM"};
        //String [] colunas = new String[20]("ID", "Nome");
        conex.Conexao();
        conex.executaSQL(sql);
        try{
        conex.rs.first();
        do{
            dados.add(new Object [] {conex.rs.getInt("num_med"), conex.rs.getString("nome"), conex.rs.getString("especialidade"), conex.rs.getInt("crm")});
        }while(conex.rs.next());
        }catch(SQLException ex){
            JOptionPane.showMessageDialog(rootPane,"Médico não cadastrado, tente outro nome");
        }
        ModeloTabela modelo = new ModeloTabela(dados, colunas);
        jTableMedico.setModel(modelo);
        jTableMedico.getColumnModel().getColumn(0).setPreferredWidth(40);
        jTableMedico.getColumnModel().getColumn(0).setResizable(false);
        jTableMedico.getColumnModel().getColumn(1).setPreferredWidth(180);
        jTableMedico.getColumnModel().getColumn(1).setResizable(false);
        jTableMedico.getColumnModel().getColumn(2).setPreferredWidth(100);
        jTableMedico.getColumnModel().getColumn(2).setResizable(false);
        jTableMedico.getColumnModel().getColumn(3).setPreferredWidth(80);
        jTableMedico.getColumnModel().getColumn(3).setResizable(false);
        jTableMedico.getTableHeader().setReorderingAllowed(false);
        jTableMedico.setAutoResizeMode(jTableMedico.AUTO_RESIZE_OFF);
        jTableMedico.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        conex.Desconecta();
    }
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(FormMedico.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(FormMedico.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(FormMedico.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(FormMedico.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new FormMedico().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify                     
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButtonCancelar;
    private javax.swing.JButton jButtonEditar;
    private javax.swing.JButton jButtonExcluir;
    private javax.swing.JButton jButtonNovo;
    private javax.swing.JButton jButtonSalvar;
    private javax.swing.JComboBox jComboBoxEspecialidade;
    private javax.swing.JFormattedTextField jFormattedTextFieldCRM;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTableMedico;
    private javax.swing.JTextField jTextFieldID;
    private javax.swing.JTextField jTextFieldNome;
    private javax.swing.JTextField jTextFieldPesquisar;
    // End of variables declaration                   
}
```
```java
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package modeloConection;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import javax.swing.JOptionPane;
import java.sql.Statement;
import java.sql.*;
import java.util.logging.Level;
import java.util.logging.Logger;


/**
 *
 * @author duran
 */
public class Conexao {
    private String url;
    private String usuario;
    private String senha;
    public Connection con;
    public Statement stm;
    public ResultSet rs;
    
    public void Conexao(){
        url = "jdbc:postgresql://localhost:5432/trabalhofinal";
        usuario = "postgres";
        senha = "123";
        
        try{
        Class.forName("org.postgresql.Driver");
        con = DriverManager.getConnection(url, usuario, senha);
        JOptionPane.showMessageDialog(null,"conexão feita!");
    }catch(Exception e){
        JOptionPane.showMessageDialog(null,"houve problema de conexão! \n"+e.getMessage());
    }
        
    }   
    
    public void executaSQL(String sql){
        
        try {
            stm = con.createStatement(rs.TYPE_SCROLL_INSENSITIVE, rs.CONCUR_READ_ONLY);
        } catch (SQLException ex) {
            Logger.getLogger(Conexao.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(null, "erro tipo \n" + ex.getMessage());
        }
        try {
            rs = stm.executeQuery(sql);
        } catch (SQLException ex) {
            Logger.getLogger(Conexao.class.getName()).log(Level.SEVERE, null, ex);
            JOptionPane.showMessageDialog(null, "erro tipo \n" + ex.getMessage());
        }
        
    }
    
     public void Desconecta(){
         
         try {
             con.close();
             JOptionPane.showMessageDialog(null, "Banco de Dados desconectado com sucesso!");
         } catch (SQLException ex) {
             JOptionPane.showMessageDialog(null,"Não conseguiu desconectar! \n" + ex.getMessage());
         }
         
}
    
}
```
```java
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package modeloBeans;

/**
 *
 * @author duran
 */
public class BeansMedico {
    private int codigo;
    private String nome;
    private String especialidade;
    private int crm;
    private String pesquisa;

    public BeansMedico() {
    }

    public int getCodigo() {
        return codigo;
    }

    public void setCodigo(int codigo) {
        this.codigo = codigo;
    }

    public String getNome() {
        return nome;
    }

    public void setNome(String nome) {
        this.nome = nome;
    }

    public String getEspecialidade() {
        return especialidade;
    }

    public void setEspecialidade(String especialidade) {
        this.especialidade = especialidade;
    }

    public int getCrm() {
        return crm;
    }

    public void setCrm(int crm) {
        this.crm = crm;
    }

    /**
     * @return the pesquisa
     */
    public String getPesquisa() {
        return pesquisa;
    }

    /**
     * @param pesquisa the pesquisa to set
     */
    public void setPesquisa(String pesquisa) {
        this.pesquisa = pesquisa;
    }
}
```
